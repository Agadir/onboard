<% 
  require 'onboard/service/radius/passwd'

  best_passwd_type  = 'SSHA1-Password'
  passwd_types      = OnBoard::Service::RADIUS::Passwd::TYPES
%>

<style type="text/css">
  table tr th[scope="row"] {
    font-size: 95%;
  }
  th select, th .optinfo {
    width: 40ex;
  }
  table tr td  {
    vertical-align: top;
  }
  table tr td, table tr th {
    padding: 1ex;
  }
  input {
    width: 24ex;
  }
</style>

<%= message_partial(msg) %>

<h2>RADIUS Users</h2>

<h3>Create new user</h3>

<form method="POST">
  <table>
    <tbody>
      <tr>
        <th scope="row">User-Name</th>
        <td><input type="text" name="check[User-Name]"/></td>
      </tr>
      <tr>
        <th scope="row">
          <select name="check[Password-Type]">
            <% passwd_types.each do |passwd_type| %>
              <% selected = 
                  (passwd_type == best_passwd_type ? 'selected' : '') %>
                <option <%= selected %> value="<%= passwd_type %>">
                  <%= passwd_type %>
                </option>
            <% end %>
          </select>
          <div class="optinfo">
            Password types reflect the way passwords are encrypted in the
            database. The strongest method is SSHA1. Cleartext should be used
            only if clients authenticate using <a href="http://en.wikipedia.org/wiki/Challenge-handshake_authentication_protocol">CHAP</a>.
          </div>
        </th>
        <td>
          <div style="margin-top:0;"> 
            <input type="password" name="check[User-Password]"/>
          </div>
          <div style="margin-top:0.7em;">
            <input type="password" name="confirm[check][User-Password]"/><br/>
            <span class="optinfo">(confirm)</span>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <button type="submit">Create</button>
</form>
